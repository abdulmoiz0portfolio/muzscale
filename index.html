<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MuzScale — MUZZAINI AI Upscaler & Studio</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="icon" href="https://fav.farm/🖼️" />
  <style>
    :root{ --bg:#0b0f14; --panel:#111723; --panel-2:#0e1420; --text:#e6edf3; --muted:#9fb0c3; --brand:#7aa2f7; --brand-2:#5b8ff0; --accent:#a6da95; --danger:#f7768e; --border:#1b2433; --chip:#1a2231; --shadow:0 10px 30px rgba(0,0,0,.35);} *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,Helvetica,sans-serif; color:var(--text); background:radial-gradient(1200px 800px at 75% -10%, #142034 0%, #0b0f14 60%) fixed, var(--bg);} a{color:var(--brand); text-decoration:none}
    .app{display:flex; flex-direction:column; min-height:100vh}
    header.appbar{position:sticky; top:0; z-index:10; backdrop-filter:saturate(120%) blur(6px); background:rgba(17,23,35,.85); border-bottom:1px solid var(--border)}
    .appbar .inner{max-width:1200px; margin:0 auto; padding:14px 20px; display:flex; align-items:center; gap:14px}
    .logo{display:flex; align-items:center; gap:10px; font-weight:700; letter-spacing:.2px}
    .logo .mark{width:28px; height:28px; display:grid; place-items:center; border-radius:8px; background:linear-gradient(135deg, var(--brand), var(--accent)); box-shadow:var(--shadow)} .logo span{font-size:18px}
    .tag{color:var(--muted); font-weight:500; margin-left:auto}
    main{flex:1}
    .container{max-width:1200px; margin:0 auto; padding:24px; display:grid; grid-template-columns: 280px 1fr 320px; gap:18px}
    @media (max-width: 1100px){ .container{grid-template-columns: 1fr; gap:16px} }
    .panel{background:linear-gradient(180deg, var(--panel), var(--panel-2)); border:1px solid var(--border); border-radius:14px; box-shadow:var(--shadow)} .panel h3{margin:0 0 10px 0; font-size:14px; letter-spacing:.3px; color:var(--muted)} .panel .body{padding:16px}
    .tools{display:flex; flex-direction:column; gap:10px}
    .tool-row{display:flex; gap:10px; flex-wrap:wrap}
    .btn{appearance:none; border:1px solid var(--border); color:var(--text); background:var(--chip); padding:10px 12px; border-radius:10px; cursor:pointer; display:inline-flex; align-items:center; gap:8px; font-weight:600; transition:.15s transform, .15s background, .15s border-color}
    .btn:hover{transform:translateY(-1px); border-color:#2a3750}
    .btn:disabled{opacity:.5; cursor:not-allowed}
    .btn.primary{background:linear-gradient(180deg, var(--brand), var(--brand-2)); border-color:#3c6bd9}
    .btn.success{background:linear-gradient(180deg, #79d08b, var(--accent)); color:#08140c; border-color:#6bc680}
    .btn.icon{width:42px; justify-content:center}
    .btn .tip{color:var(--muted); font-weight:500}
    .workbench{position:relative; min-height:420px; display:grid; place-items:center; overflow:hidden}
    .dropzone{border:1.5px dashed #2a3750; background:rgba(20,28,42,.35); color:var(--muted); padding:42px 18px; border-radius:14px; text-align:center; width:min(720px, 100%); cursor:pointer}
    .dropzone .big{font-size:48px; margin-bottom:6px}
    .preview-wrap{width:100%; height:100%; display:none; position:relative}
    canvas#canvas{max-width:100%; max-height:70vh; border-radius:10px; background:#0a0f17}
    .toolbar{position:absolute; bottom:14px; left:50%; transform:translateX(-50%); display:flex; gap:8px; background:rgba(15,21,33,.7); border:1px solid var(--border); padding:8px; border-radius:12px; backdrop-filter:blur(6px); box-shadow:var(--shadow)}
    .props{display:flex; flex-direction:column; gap:18px}
    .field{display:grid; grid-template-columns:1fr auto; align-items:center; gap:10px}
    .field label{color:var(--muted); font-size:13px}
    .field input[type=range]{width:100%}
    .chips{display:flex; flex-wrap:wrap; gap:8px}
    .footer{max-width:1200px; margin:0 auto; padding:18px 24px; color:var(--muted); border-top:1px solid var(--border)}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background:#0c1422; border:1px solid var(--border); padding:0 6px; border-radius:6px}
    /* MUZZAINI AI Landing + Modals + Image Generator */
    .loading-screen{position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(135deg,#2d3748,#4a5568);display:none;flex-direction:column;justify-content:center;align-items:center;z-index:9999;transition:opacity .5s ease-out}
    .loading-screen.show{display:flex}
    .loading-screen.fade-out{opacity:0;pointer-events:none}
    .loader{width:80px;height:80px;border:4px solid rgba(255,255,255,.1);border-left:4px solid #4c6ef5;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:30px}
    @keyframes spin{to{transform:rotate(360deg)}}
    .loading-text{font-size:1.5rem;margin-bottom:10px;background:linear-gradient(45deg,#4c6ef5,#ffd700);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-weight:600}
    .loading-subtitle{font-size:1rem;color:#e2e8f0;opacity:.7;animation:pulse 2s ease-in-out infinite}
    @keyframes pulse{0%,100%{opacity:.7}50%{opacity:1}}
    .progress-bar{width:200px;height:4px;background:rgba(255,255,255,.1);border-radius:2px;margin-top:20px;overflow:hidden}
    .progress-fill{height:100%;background:linear-gradient(90deg,#4c6ef5,#ffd700);width:0;border-radius:2px;animation:loadProgress 2.5s ease-out forwards}
    @keyframes loadProgress{0%{width:0}25%{width:30%}50%{width:60%}75%{width:85%}100%{width:100%}}
    .landing-page{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:100vh;background:linear-gradient(135deg,#2d3748,#4a5568);text-align:center;padding:40px}
    .landing-title{font-size:3rem;font-weight:800;margin-bottom:12px;background:linear-gradient(45deg,#4c6ef5,#ffd700);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .landing-subtitle{font-size:1.2rem;margin-bottom:28px;color:#e2e8f0;opacity:.9}
    .get-started-btn{padding:14px 28px;font-size:1.05rem;background:linear-gradient(135deg,#4c6ef5,#3b5bdb);border:none;border-radius:50px;color:#fff;cursor:pointer;transition:.25s;box-shadow:0 8px 25px rgba(76,110,245,.35);font-weight:700}
    .get-started-btn:hover{transform:translateY(-3px);box-shadow:0 12px 35px rgba(76,110,245,.5);background:linear-gradient(135deg,#3b5bdb,#2948c7)}
    .features-preview{margin-top:34px;display:flex;gap:16px;opacity:.85;flex-wrap:wrap;justify-content:center}
    .feature-icon{font-size:1rem;padding:10px 12px;background:rgba(255,255,255,.08);border-radius:12px;backdrop-filter:blur(10px)}
    .modal-container{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.85);display:none;justify-content:center;align-items:center;z-index:10000;padding:16px}
    .modal-form{background:#2d3748;padding:24px;border-radius:14px;width:100%;max-width:520px;text-align:center;box-shadow:0 10px 40px rgba(0,0,0,.5)}
    .modal-form h2{margin-top:0;color:#4c6ef5}
    .modal-form p{color:#a0aec0;margin-bottom:18px}
    .modal-input{width:100%;padding:12px;margin-bottom:12px;border-radius:8px;border:1px solid #4a5568;background:#1a202c;color:#fff;font-size:15px}
    .modal-submit{width:100%;padding:12px 30px;background:#4c6ef5;color:#fff;border:none;border-radius:8px;cursor:pointer;font-size:16px}
    .modal-submit:hover{background:#3b5bdb}
    .skip-btn{background:#6c757d;margin-top:10px}
    .skip-btn:hover{background:#5a6268}
    .app-container{display:none}
    .top-bar{padding:12px 16px;display:flex;justify-content:space-between;align-items:center;background:#111723;border-bottom:1px solid var(--border)}
    .top-bar-btn{padding:10px 16px;background:#4a5568;border:none;border-radius:8px;color:#fff;cursor:pointer;text-decoration:none}
    .logout-btn{background:#c53030}
    .chat-wrapper{max-width:900px;margin:20px auto;display:flex;flex-direction:column;border-radius:16px;background:#131a26;box-shadow:0 8px 30px rgba(0,0,0,.5);height:78vh;overflow:hidden;border:1px solid var(--border)}
    .chat-container{flex:1;padding:14px;overflow-y:auto;background:#0f1521}
    .chat-input{display:flex;gap:10px;padding:12px;background:#101622;border-top:1px solid var(--border)}
    #commandInput{flex:1;border-radius:14px;border:1px solid #2a3750;padding:10px 14px;background:#0d1422;color:#fff}
    .message{display:flex;margin-bottom:12px}
    .user-message{justify-content:flex-end}
    .assistant-message{justify-content:flex-start}
    .message-content{max-width:70%;border-radius:12px;padding:10px 14px}
    .user-message .message-content{background:#4c6ef5}
    .assistant-message .message-content{background:#202b3d}
    .image-generator-wrapper{max-width:900px;margin:20px auto;background:#131a26;border-radius:16px;padding:16px;box-shadow:0 8px 30px rgba(0,0,0,.5);border:1px solid var(--border)}
    #imagePromptInput{width:40%;padding:12px;border-radius:10px;border:1px solid #2a3750;background:#0d1422;color:#fff}
    #imageSizeInput,#imageCountInput{padding:12px;border-radius:10px;border:1px solid #2a3750;background:#0d1422;color:#fff}
    .image-status{background:#101622;text-align:center;padding:10px;font-size:14px;border-radius:10px;border:1px solid var(--border)}
    .spinner{width:20px;height:20px;border:3px solid rgba(255,255,255,.2);border-top-color:#4c6ef5;border-radius:50%;animation:spin 1s linear infinite}
  </style>
</head>
<body>
  <!-- MUZZAINI AI Landing -->
  <section id="landing" class="landing-page">
    <h1 class="landing-title">MUZZAINI AI</h1>
    <p class="landing-subtitle">Upscale, edit, and generate images in a modern studio.</p>
    <button id="startBtn" class="get-started-btn">Get Started</button>
    <div class="features-preview">
      <div class="feature-icon">⚡ Upscale 2x-4x</div>
      <div class="feature-icon">✏️ Quick Edits</div>
      <div class="feature-icon">🎨 Image Generator</div>
      <div class="feature-icon">💬 Chat Commands</div>
    </div>
  </section>

  <!-- MUZZAINI AI Modal (name/email - optional) -->
  <div id="introModal" class="modal-container" role="dialog" aria-modal="true" aria-label="Welcome">
    <div class="modal-form">
      <h2>Welcome to MUZZAINI AI</h2>
      <p>Optionally share your name/email to personalize the studio. You can skip.</p>
      <input id="userName" class="modal-input" placeholder="Your name (optional)" />
      <input id="userEmail" class="modal-input" placeholder="Your email (optional)" />
      <button id="saveIntro" class="modal-submit">Continue</button>
      <button id="skipIntro" class="modal-submit skip-btn">Skip</button>
    </div>
  </div>

  <!-- App Shell -->
  <div class="app" id="appShell" style="display:none">
    <header class="appbar">
      <div class="inner">
        <div class="logo" aria-label="MuzScale logo"><div class="mark">🖼️</div><span>MuzScale</span></div>
        <span class="tag">MUZZAINI AI Studio</span>
      </div>
    </header>

    <main>
      <div class="container">
        <!-- Left tools -->
        <aside class="panel">
          <div class="body tools">
            <h3>Tools</h3>
            <div class="tool-row">
              <button id="flipHBtn" class="btn" title="Flip image horizontally">↔ <span class="tip">Flip H</span></button>
              <button id="flipVBtn" class="btn" title="Flip image vertically">↕ <span class="tip">Flip V</span></button>
              <button id="rotateLeftBtn" class="btn icon" title="Rotate left">↶</button>
              <button id="rotateRightBtn" class="btn icon" title="Rotate right">↷</button>
              <button id="resetBtn" class="btn" title="Reset all edits">↺ <span class="tip">Reset</span></button>
            </div>
            <div class="tool-row">
              <button id="zoomInBtn" class="btn icon" title
